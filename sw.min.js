self.addEventListener('install',(event)=>{console.log('install');self.skipWaiting();event.waitUntil(caches.open('v10').then((cache)=>{return cache.addAll(['/albertforfuture.de/custom.min.css','/albertforfuture.de/logo.min.svg','https://mohe2015.github.io/albertforfuture.de/bundle.js','https://mohe2015.github.io/albertforfuture.de/sw.min.js','/albertforfuture.de/manifest.min.json','https://mohe2015.github.io/albertforfuture.de//offline/',]);}));});self.addEventListener('activate',event=>{console.log('activate_');self.clients.claim();event.waitUntil(caches.keys().then(function(cacheNames){return Promise.all(cacheNames.filter(function(cacheName){return cacheName!=='v10';}).map(function(cacheName){return caches.delete(cacheName);}));}));});self.addEventListener('fetch',(event)=>{var pathname=new URL(event.request.url).pathname;event.respondWith(caches.match(event.request).then(cacheResponse=>{return cacheResponse||fetch(event.request).then(response=>{return caches.open('v10').then(cache=>{cache.put(event.request,response.clone());return response;});}).catch(error=>{return caches.match('/offline/').then(function(response){return response;});});}))});self.addEventListener('notificationclose',event=>{const notification=event.notification;const primaryKey=notification.data.primaryKey;console.log('Closed notification: '+primaryKey);});self.addEventListener('notificationclick',event=>{const notification=event.notification;const primaryKey=notification.data.primaryKey;const action=event.action;if(action==='close'){notification.close();}else{event.waitUntil(clients.matchAll().then(clis=>{const client=clis.find(c=>{return c.visibilityState==='visible';});if(client!==undefined){client.navigate('samples/page'+primaryKey+'.html');client.focus();}else{clients.openWindow('samples/page'+primaryKey+'.html');notification.close();}}));}
self.registration.getNotifications().then(notifications=>{notifications.forEach(notification=>{notification.close();});});});self.addEventListener('push',event=>{let body;if(event.data){body=event.data.text();}else{body='Default body';}
const options={body:body,icon:'images/notification-flat.png',vibrate:[100,50,100],data:{dateOfArrival:Date.now(),primaryKey:1},actions:[{action:'explore',title:'Go to the site',icon:'images/checkmark.png'},{action:'close',title:'Close the notification',icon:'images/xmark.png'},]};event.waitUntil(clients.matchAll().then(c=>{console.log(c);if(c.length===0){self.registration.showNotification('Push Notification',options);}else{console.log('Application is already open!');}}));});